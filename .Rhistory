install.packages('knitr')
install.packages("knitr")
install.packages("knitr")
install.packages('kableExtra')
install.packages("kableExtra")
install.packages("rmarkdown")
install.packages("rmarkdown")
setwd("C:/Users/tcarruth/Documents/GitHub/DLMDev/Testing/MERA")
library(DLMtool)
MSEobj<-runMSE(testOM,MPs=c("DCAC","MCD","DBSRA"))
testOM_reb<-testOM
testOM_reb@D<-c(0.1,0.15)
MSEobj_reb<-runMSE(testOM_reb,MPs=c("DCAC","MCD","DBSRA"))
datatable(Tab1)
library(DT)
datatable(Tab1)
nMPs<-MSEobj@nMPs
proyears<-MSEobj@proyears
ind<-(0:1000*res)
ind<-ind[ind<=min(planning_phase,proyears)]
LRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>0.5,2:3,mean)*100,rnd)[,ind]
#TRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>1,2:3,mean)*100,rnd)
Tab1<-as.data.frame(cbind(MSEobj@MPs,LRP))
colnams<-c("MP",ind+Current_Year)
Tab1
names(Tab1)<-colnams
datatable(Tab1)
Tab1<-as.data.frame(cbind(MSEobj@MPs,LRP))
colnams<-c("MP",ind+Current_Year)
names(Tab1)<-colnams
colnams
Tab1
nMPs<-MSEobj@nMPs
proyears<-MSEobj@proyears
ind<-(1:1000*res)
ind
nMPs<-MSEobj@nMPs
proyears<-MSEobj@proyears
ind<-1+(0:1000*res)
ind<-ind[ind<=min(planning_phase,proyears)]
LRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>0.5,2:3,mean)*100,rnd)[,ind]
#TRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>1,2:3,mean)*100,rnd)
Tab1<-as.data.frame(cbind(MSEobj@MPs,LRP))
colnams<-c("MP",ind+Current_Year)
names(Tab1)<-colnams
datatable(Tab1)
rnd=1
nMPs<-MSEobj@nMPs
proyears<-MSEobj@proyears
ind<-1+(0:1000*res)
ind<-ind[ind<=min(planning_phase,proyears)]
LRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>0.5,2:3,mean)*100,rnd)[,ind]
#TRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>1,2:3,mean)*100,rnd)
Tab1<-as.data.frame(cbind(MSEobj@MPs,LRP))
colnams<-c("MP",ind+Current_Year)
names(Tab1)<-colnams
datatable(Tab1)
nTabs<-2
Tab_title<-list()
Tab_text<-list()
Tab_title[[1]] <- "Test table 1 title"
Tab_text[[1]] <-"Test table 1 text"
Tabs[[1]]<-function(MSEobj,planning_phase=50,rnd=1,res=5){
nMPs<-MSEobj@nMPs
proyears<-MSEobj@proyears
ind<-1+(0:1000*res)
ind<-ind[ind<=min(planning_phase,proyears)]
LRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>0.5,2:3,mean)*100,rnd)[,ind]
#TRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>1,2:3,mean)*100,rnd)
Tab1<-as.data.frame(cbind(MSEobj@MPs,LRP))
colnams<-c("MP",ind+Current_Year)
names(Tab1)<-colnams
datatable(Tab1)
}
Tab_title[[2]] <- "Test table 2 title"
Tab_text[[2]] <-"Test table 2 text"
Tabs[[2]]<-function(MSEobj,planning_phase=50,rnd=1,res=5){
nMPs<-MSEobj@nMPs
proyears<-MSEobj@proyears
ind<-1+(0:1000*res)
ind<-ind[ind<=min(planning_phase,proyears)]
#LRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>0.5,2:3,mean)*100,rnd)[,ind]
TRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>1,2:3,mean)*100,rnd)
Tab2<-as.data.frame(cbind(MSEobj@MPs,TRP))
colnams<-c("MP",ind+Current_Year)
names(Tab2)<-colnams
datatable(Tab2)
}
Planning<-list(nTabs,Tab_title,Tab_text,Tabs)
nTabs<-2
Tab_title <- Tab_text <- Tabs <- list()
Tab_title[[1]] <- "Test table 1 title"
Tab_text[[1]] <-"Test table 1 text"
Tabs[[1]]<-function(MSEobj,planning_phase=50,rnd=1,res=5){
nMPs<-MSEobj@nMPs
proyears<-MSEobj@proyears
ind<-1+(0:1000*res)
ind<-ind[ind<=min(planning_phase,proyears)]
LRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>0.5,2:3,mean)*100,rnd)[,ind]
#TRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>1,2:3,mean)*100,rnd)
Tab1<-as.data.frame(cbind(MSEobj@MPs,LRP))
colnams<-c("MP",ind+Current_Year)
names(Tab1)<-colnams
datatable(Tab1)
}
Tab_title[[2]] <- "Test table 2 title"
Tab_text[[2]] <-"Test table 2 text"
Tabs[[2]]<-function(MSEobj,planning_phase=50,rnd=1,res=5){
nMPs<-MSEobj@nMPs
proyears<-MSEobj@proyears
ind<-1+(0:1000*res)
ind<-ind[ind<=min(planning_phase,proyears)]
#LRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>0.5,2:3,mean)*100,rnd)[,ind]
TRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>1,2:3,mean)*100,rnd)
Tab2<-as.data.frame(cbind(MSEobj@MPs,TRP))
colnams<-c("MP",ind+Current_Year)
names(Tab2)<-colnams
datatable(Tab2)
}
Planning<-list(nTabs,Tab_title,Tab_text,Tabs)
do.call(Planning$Tabs[[1]])
Planning$Tabs[[1]]
Planning$Tabs
Planning
Planning<-list(nTabs=nTabs,Tab_title=Tab_title,Tab_text=Tab_text,Tabs=Tabs)
do.call(Planning$Tabs[[1]])
Planning$Tabs
Planning$Tabs[[1]]
Planning$Tabs[[2]]
Planning[[1]][[1]](MSEobj)
nTabs<-2
Tab_title <- Tab_text <- Tabs <- list()
Tab_title[[1]] <- "Test table 1 title"
Tab_text[[1]] <-"Test table 1 text"
Tabs[[1]]<-function(MSEobj,planning_phase=50,rnd=1,res=5){
nMPs<-MSEobj@nMPs
proyears<-MSEobj@proyears
ind<-1+(0:1000*res)
ind<-ind[ind<=min(planning_phase,proyears)]
LRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>0.5,2:3,mean)*100,rnd)[,ind]
#TRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>1,2:3,mean)*100,rnd)
Tab1<-as.data.frame(cbind(MSEobj@MPs,LRP))
colnams<-c("MP",ind+Current_Year)
names(Tab1)<-colnams
datatable(Tab1)
}
Tab_title[[2]] <- "Test table 2 title"
Tab_text[[2]] <-"Test table 2 text"
Tabs[[2]]<-function(MSEobj,planning_phase=50,rnd=1,res=5){
nMPs<-MSEobj@nMPs
proyears<-MSEobj@proyears
ind<-1+(0:1000*res)
ind<-ind[ind<=min(planning_phase,proyears)]
#LRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>0.5,2:3,mean)*100,rnd)[,ind]
TRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>1,2:3,mean)*100,rnd)
Tab2<-as.data.frame(cbind(MSEobj@MPs,TRP))
colnams<-c("MP",ind+Current_Year)
names(Tab2)<-colnams
datatable(Tab2)
}
Planning<-list(Tabs=Tabs,nTabs=nTabs,Tab_title=Tab_title,Tab_text=Tab_text)
Planning[[1]][[1]](MSEobj)
Planning[[1]][[2]](MSEobj)
shiny::runApp('~/GitHub/MERA/inst/shiny_apps/MERA')
Planning[[1]][[2]](MSEobj)
shiny::runApp('~/GitHub/MERA/inst/shiny_apps/MERA')
shiny::runApp('~/GitHub/MERA/inst/shiny_apps/MERA')
?datatable
runApp('~/GitHub/MERA/inst/shiny_apps/MERA')
Tab1<-data.frame(testy=runif(5),testy2=runif(5))
datatable(Tab1)
runApp('~/GitHub/MERA/inst/shiny_apps/MERA')
nMPs<-MSEobj@nMPs
proyears<-MSEobj@proyears
ind<-1+(0:1000*res)
ind<-ind[ind<=min(planning_phase,proyears)]
LRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>0.5,2:3,mean)*100,rnd)[,ind]
#TRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>1,2:3,mean)*100,rnd)
Tab1<-as.data.frame(cbind(MSEobj@MPs,LRP))
colnams<-c("MP",ind+Current_Year)
datatable(Tab1)
nMPs<-MSEobj@nMPs
proyears<-MSEobj@proyears
ind<-1+(0:1000*res)
ind<-ind[ind<=min(planning_phase,proyears)]
LRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>0.5,2:3,mean)*100,rnd)[,ind]
#TRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>1,2:3,mean)*100,rnd)
Tab1<-as.data.frame(cbind(MSEobj@MPs,LRP))
colnams<-c("MP",ind+Current_Year)
datatable(Tab1)
nMPs<-MSEobj@nMPs
proyears<-MSEobj@proyears
ind<-1+(0:1000*res)
ind<-ind[ind<=min(planning_phase,proyears)]
LRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>0.5,2:3,mean)*100,rnd)[,ind]
as.data.frame(cbind(MSEobj@MPs,LRP))
rnd=1
res=5
planning_phase=50
nMPs<-MSEobj@nMPs
proyears<-MSEobj@proyears
ind<-1+(0:1000*res)
ind<-ind[ind<=min(planning_phase,proyears)]
LRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>0.5,2:3,mean)*100,rnd)[,ind]
#TRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>1,2:3,mean)*100,rnd)
Tab1<-as.data.frame(cbind(MSEobj@MPs,LRP))
colnams<-c("MP",ind+Current_Year)
datatable(Tab1)
colnams
nMPs<-MSEobj@nMPs
proyears<-MSEobj@proyears
ind<-1+(0:1000*res)
ind<-ind[ind<=min(planning_phase,proyears)]
LRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>0.5,2:3,mean)*100,rnd)[,ind]
#TRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>1,2:3,mean)*100,rnd)
Tab1<-as.data.frame(cbind(MSEobj@MPs,LRP))
colnams<-c("MP",ind+Current_Year)
names(Tab1)<-colnams
datatable(Tab1)
nMPs<-MSEobj@nMPs
proyears<-MSEobj@proyears
ind<-1+(0:1000*res)
ind<-ind[ind<=min(planning_phase,proyears)]
#LRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>0.5,2:3,mean)*100,rnd)[,ind]
TRP<-round(apply(MSEobj@B_BMSY[,,1:planning_phase,drop=FALSE]>1,2:3,mean)*100,rnd)
Tab2<-as.data.frame(cbind(MSEobj@MPs,TRP))
colnams<-c("MP",ind+Current_Year)
names(Tab2)<-colnams
datatable(Tab2)
runApp('~/GitHub/MERA/inst/shiny_apps/MERA')
wormplot(MSEobj)
Pplot3
runApp('~/GitHub/MERA/inst/shiny_apps/MERA')
maxcol=6
qcol=rgb(0.4,0.8,0.95)
lcol= "dodgerblue4"
quants=c(0.05,0.25,0.75,0.95)
maxrow=NA
MPcols<-rep('purple',MSEobj@nMPs)
if(is.na(maxcol))maxcol=ceiling(length(MSEobj@MPs)/0.5) # defaults to portrait 1:2
MPs<-MSEobj@MPs
nMPs<-length(MPs)
yrs<-Current_Year+(1:MSEobj@proyears)
MPcols[MPcols=="green"]<-"darkgreen"
plots<-split(1:nMPs, ceiling(seq_along(1:nMPs)/maxcol))
nr<-length(plots)*2
if(!is.na(maxrow))nr=max(nr,maxrow)
nc<-maxcol
mat<-array(0,c(nc,nr*1.5))
ind<-floor(0.5+(1:nr)*1.5)
mat[,ind]<-1:(nr*nc)
mat<-t(mat)
ht<-rep(0.2,nr*1.5)
ht[ind]<-1
layout(mat,heights=ht)
par(mai=c(0.3,0.3,0.01,0.01),omi=c(0.5,0.5,0.05,0.05))
B_BMSY<-MSEobj@B_BMSY
Yd<-MSEobj@C/ array(rep(MSEobj@C[,,1],MSEobj@proyears),dim(MSEobj@C))#MSEobj@OM$RefY
Yd[is.na(Yd)]<-0
Blims <- c(0,quantile(B_BMSY,0.95))
Ylims<- c(0,quantile(Yd,0.95))
for(pp in 1:length(plots)){
toplot<-unlist(plots[pp])
nt<-length(toplot)
for(i in toplot){
plot(range(yrs),Blims,col="white")
plotquant(B_BMSY[,i,],p=quants,yrs,qcol,lcol,ablines=c(0.5,1))
mtext(MSEobj@MPs[i],3,line=0.2,font=2,col=MPcols[i])
if(i==toplot[1])mtext("B/BMSY",2,line=2.3)
}
if(nt<maxcol)for(i in 1:(maxcol-nt))plot(NULL, xlim=c(0,1), ylim=c(0,1), ylab="y label", xlab="x lablel",axes=F)
for(i in toplot){
plot(range(yrs),Ylims,col="white")
plotquant(Yd[,i,],p=quants,yrs,qcol,lcol,ablines=1)
if(i==toplot[1])mtext("Yield relative to today",2,line=2.3)
}
if(nt<maxcol)for(i in 1:(maxcol-nt))plot(NULL, xlim=c(0,1), ylim=c(0,1), ylab="y label", xlab="x lablel",axes=F)
}
mtext("Projection Year",1,line=0.7,outer=T)
runApp('~/GitHub/MERA/inst/shiny_apps/MERA')
